[ ca ]
default_ca = k8s_root_ca

[ k8s_root_ca ]
dir           = /home/debian/k8s-ca
certs		      = $dir/certs
crl_dir		    = $dir/crl
new_certs_dir	= $dir/newcerts
database	    = $dir/index.txt
serial		    = $dir/serial
crlnumber	    = $dir/crlnum

private_key	= $dir/private/ca.key
certificate	= $dir/certs/ca.crt

default_md	  = sha256
default_days	= 365
policy		    = k8s_policy

unique_subject	= no
copy_extensions = copy

[ k8s_policy ]
commonName		          = supplied
organizationName	      = optional
organizationalUnitName	= optional
countryName		          = optional
stateOrProvinceName	    = optional
localityName		        = optional
emailAddress		        = optional

[ req ]
default_bits		    = 4096
default_md		      = sha256
prompt			        = no
distinguished_name	= req_dn

[ req_dn ]
CN	= kubernetes-root-ca
O	  = kubernetes

[ v3_ca ]
subjectKeyIdentifier	  = hash
authorityKeyIdentifier	= keyid:always,issuer
basicConstraints	      = critical, CA:true
keyUsage		            = critical, keyCertSign, cRLSign

########################################################
# Certificate Profiles
########################################################

[ client_cert ]
basicConstraints        = CA:FALSE
keyUsage                = critical, digitalSignature, keyEncipherment
extendedKeyUsage        = clientAuth
subjectKeyIdentifier    = hash
authorityKeyIdentifier  = keyid,issuer

[ server_cert ]
basicConstraints        = CA:FALSE
keyUsage                = critical, digitalSignature, keyEncipherment
extendedKeyUsage        = serverAuth
subjectKeyIdentifier    = hash
authorityKeyIdentifier  = keyid,issuer

[ peer_cert ]
basicConstraints        = CA:FALSE
keyUsage                = critical, digitalSignature, keyEncipherment
extendedKeyUsage        = serverAuth, clientAuth
subjectKeyIdentifier    = hash
authorityKeyIdentifier  = keyid,issuer
